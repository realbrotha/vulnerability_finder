//
// Created by realbro on 10/5/20.
//

#ifndef NUNU_SRC_NUNU_ABSOLUTEZERO_H_
#define NUNU_SRC_NUNU_ABSOLUTEZERO_H_

#include <string>
#include <vector>
#include <functional>

#include "ActionHandler.h"

struct RULES {
  std::string tags;
  std::string descrption;
  std::string success_message;
  std::string failed_message;
};

typedef std::function<void(struct RULES rules)> ResponseCallback;

class AbsoluteZero {
 public:
  AbsoluteZero();
  ~AbsoluteZero();

  bool Initialize(std::string file_path, bool use_async = false);
  bool SetCallback(ResponseCallback pre_scan, ResponseCallback success_scan, ResponseCallback failed_scan);
  bool Finalize();

  bool StartScan();
  bool Start();
 private:

  bool rule_verified;
  std::string rule_file_path_;

  ActionHandler action_handler_;

  ResponseCallback pre_scan_;
  ResponseCallback success_scan_;
  ResponseCallback failed_scan_;
};

#endif //NUNU_SRC_NUNU_ABSOLUTEZERO_H_

