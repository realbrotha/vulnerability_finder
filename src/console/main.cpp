//
// Created by realbro on 10/5/20.
//

#include <stdio.h>
#include <string>
#include "../nunu/AbsoluteZero.h"

void PreScan(struct RULES rule) {
  printf ("[%s] %s\n",  rule.tags.c_str(), rule.descrption.c_str());
  return;
}
void SuccesScan(struct RULES rule) {
  printf ("(정상) 검사결과 이상 없습니다.\n\n");

  return;
}
void FailedScan(struct RULES rule) {
  printf ("(취약) %s\n\n", rule.failed_message.c_str());
  return;
}
int main (int argc, char *argv[]) {

  std::string test = "test.txt";
  AbsoluteZero az;
  az.Initialize(test);
  az.SetCallback(PreScan, SuccesScan, FailedScan);
  printf ("************************ 검사를 시작합니다. ************************\n");
  az.Start();
  printf ("****************************************************************\n");
}